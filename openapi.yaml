openapi: 3.1.0
info:
  title: Fiumi Romagna - Hydrometric Levels
  version: 0.1.0
  description: API for river hydrometric levels from Allerta Emilia-Romagna.
servers:
  - url: https://YOUR_PUBLIC_DOMAIN
paths:
  /health:
    get:
      operationId: healthCheck
      summary: Health check
      responses:
        "200":
          description: Server is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
  /livello-idrometrico:
    get:
      operationId: getHydrometricLevel
      summary: Get hydrometric level for a river or station
      parameters:
        - name: fiume
          in: query
          required: true
          description: River or station name (e.g. Ronco, Ponte Uso)
          schema:
            type: string
        - name: max_results
          in: query
          required: false
          description: Max number of matched stations (default 10)
          schema:
            type: integer
            minimum: 1
            maximum: 100
      responses:
        "200":
          description: Hydrometric levels
          content:
            application/json:
              schema:
                type: object
                properties:
                  query:
                    type: string
                  timestamp_ms:
                    type: integer
                  timestamp_iso:
                    type: string
                  matches:
                    type: array
                    items:
                      $ref: "#/components/schemas/StationReading"
                  suggestions:
                    type: array
                    items:
                      type: string
  /stazioni:
    get:
      operationId: listStations
      summary: List hydrometric stations
      parameters:
        - name: filtro
          in: query
          required: false
          description: Text filter for station name
          schema:
            type: string
        - name: max_results
          in: query
          required: false
          description: Max number of stations returned (default 50)
          schema:
            type: integer
            minimum: 1
            maximum: 100
      responses:
        "200":
          description: Station list
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                  stations:
                    type: array
                    items:
                      $ref: "#/components/schemas/StationReading"
components:
  schemas:
    StationReading:
      type: object
      properties:
        idstazione:
          type: string
        nomestaz:
          type: string
        value:
          type: number
          nullable: true
        value_formatted:
          type: string
        soglia1:
          type: number
        soglia2:
          type: number
        soglia3:
          type: number
        lat:
          type: string
        lon:
          type: string
